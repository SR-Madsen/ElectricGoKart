/*
 * axiinterface.h
 *
 *  Created on: Apr 27, 2021
 *      Author: sebastian
 */

#ifndef SRC_AXIINTERFACE_H_
#define SRC_AXIINTERFACE_H_

#include <stdio.h>
#include "platform.h"
#include "xparameters.h"
#include "Encoder_Driver.h"
#include "PWM_Generator.h"

// Defines
#define ENCODER_DRIVER_ADDR XPAR_ENCODER_DRIVER_0_S00_AXI_BASEADDR
#define PWM_GENERATOR_ADDR XPAR_PWM_GENERATOR_0_S00_AXI_BASEADDR

// Structs
typedef struct dutycycles_t {
	u32 duty1;
	u32 duty2;
	u32 duty3;
} dutycycles_t;

// Variables


// Functions
// Read the motor position from the encoder
// Output: raw position value from 0 to 255 indicating motor position.
// Must be re-calculated as radians.
void readPosition(u32 *raw_pos);

void rawToRads(u32 raw_pos, long *pos_rad);

void setDutyCycles(dutycycles_t *duties);

#endif /* SRC_AXIINTERFACE_H_ */
